<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Mark Novak" />

  
  
  
    
  
  <meta name="description" content="

Before you arrive at RMBL.
Intro to network data visualization." />

  
  <link rel="alternate" hreflang="en-us" href="https://models4data2theory.github.io/courses/prework_network-visualization/" />

  
  
  
    <meta name="theme-color" content="#0072ff" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.c5fb49caf56e2b73a0f72d0102f2d0ca.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu0409958f157fc50d4e355b357a277bb5_195869_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0409958f157fc50d4e355b357a277bb5_195869_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://models4data2theory.github.io/courses/prework_network-visualization/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="Integrating Theory and Data in Plant-Pollinator Interactions" />
  <meta property="og:url" content="https://models4data2theory.github.io/courses/prework_network-visualization/" />
  <meta property="og:title" content="Prework - Network Visualization | Integrating Theory and Data in Plant-Pollinator Interactions" />
  <meta property="og:description" content="

Before you arrive at RMBL.
Intro to network data visualization." /><meta property="og:image" content="https://models4data2theory.github.io/media/icon_hu0409958f157fc50d4e355b357a277bb5_195869_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://models4data2theory.github.io/media/icon_hu0409958f157fc50d4e355b357a277bb5_195869_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2025-08-27T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2025-08-27T00:00:00&#43;00:00">
  

  



  

  

  





  <title>Prework - Network Visualization | Integrating Theory and Data in Plant-Pollinator Interactions</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="858207fbe22231e3cd612c903d2e0568" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.14a0ed61c6dbd594b9c75193b25be179.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Integrating Theory and Data in Plant-Pollinator Interactions</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Integrating Theory and Data in Plant-Pollinator Interactions</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/schedule"><span>Schedule</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/courses"><span>Content</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://www.rmbl.org" target="_blank" rel="noopener"><span>Venue</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/faqs"><span>FAQs</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/fliers/models4data2theory_2025.pdf"><span>Flier</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/thanks"><span>Thanks</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://rmbl.wufoo.com/forms/mcd6uso1hlrigy/" target="_blank" rel="noopener"><span>Apply</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
          Workshop Content
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/courses/">Workshop Content</a></li>
    
      


  <li class=""><a href="/courses/prework_02_data_basics/">Prework - R Data Basics</a></li>



  <li class=""><a href="/courses/prework_edgelist-to-network/">Prework - Edgelist-to-Network</a></li>



  <li class="active"><a href="/courses/prework_network-visualization/">Prework - Network Visualization</a></li>



  <li class=""><a href="/courses/wkshp_networks/">Networks</a></li>



  <li class=""><a href="/courses/wkshp_interactions/">Model fitting</a></li>



  <li class=""><a href="/courses/wkshp_dynamics/">Dynamics</a></li>



  <li class=""><a href="/courses/potential_use_or_interest/">Of Potential Interest</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      

      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#basics">Basics</a></li>
    <li><a href="#network-diagrams">Network diagrams</a></li>
    <li><a href="#matrix-depictions">Matrix depictions</a></li>
    <li><a href="#standardizing-matrix-depictions">Standardizing Matrix Depictions</a>
      <ul>
        <li><a href="#how-to-standardize">How to standardize</a></li>
        <li><a href="#diagonal-arrangement">Diagonal arrangement</a></li>
      </ul>
    </li>
    <li><a href="#limitations-and-alterations-to-visweb">Limitations and alterations to <code>visweb</code></a></li>
    <li><a href="#exercises">Exercises</a>
      <ul>
        <li><a href="#for-those-new-to-plotting-networks">For those new to plotting networks</a></li>
        <li><a href="#for-those-with-experience-plotting-networks">For those with experience plotting networks</a></li>
      </ul>
    </li>
    <li><a href="#alterations">Alterations</a>
      <ul>
        <li><a href="#grid-graphics">Grid Graphics</a></li>
        <li><a href="#ggplot-geom_raster">ggplot <code>geom_raster</code></a></li>
      </ul>
    </li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Prework - Network Visualization</h1>

          <div class="article-style">
            <script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />
<p><em>Before you arrive at RMBL.</em></p>
<p>Intro to network data visualization.</p>
<p>Watch this quick video (5:24 min.).</p>
  <iframe width="280" height="158" src="https://www.youtube-nocookie.com/embed/Y5uRVv7GGQM?si=LoqDEnz06F5n0OXf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
<!-- packages -->
<h2 id="overview">Overview</h2>
<p>There are two basic ways of visualizing networks:</p>
<ul>
<li><strong>network diagrams</strong> (which show nodes as shapes, and links as lines between nodes)</li>
<li><strong>matrix format</strong> (where each node is a row and/or a column, and interactions are denoted in the cells aligned with a given row and column)</li>
</ul>
<p>While understanding those two basic formats is foundationaly important for working with networks, visualization is a large and complex topic, so we will only cover a bare minimum here.</p>
<h2 id="basics">Basics</h2>
<p>We will largely focus on using the <code>bipartite</code> library and its plotting functions. <code>bipartite</code> is great in lots of ways and its plotting methods are functional, though certainly far from amazing. There are alternative R packages that also allow for plotting, for example the <code>igraph</code> library; but we will leave that to you to explore if you are interested.</p>
<p><code>bipartite</code> has two primary functions for plotting networks, that align with the two basic ways of visualizing networks we mentioned above:</p>
<ul>
<li>for network diagrams, the <code>plotweb()</code> function</li>
<li>for matrix depictions, the <code>visweb()</code> function</li>
</ul>
<h2 id="network-diagrams">Network diagrams</h2>
<p>We&rsquo;ll use data that are included in the <code>bipartite</code> package for our plotting exercises. We&rsquo;ll start with the <code>Safariland</code> dataset, collected at a theme park in Argentina by Diego Vázquez and collaborators, because it&rsquo;s a small and straightforward dataset to visualize.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">bipartite</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">kableExtra</span><span class="p">)</span> <span class="c1"># for nicely-formatted tables</span>
</span></span><span class="line"><span class="cl"><span class="nf">data</span><span class="p">(</span><span class="n">Safariland</span><span class="p">)</span>
</span></span></code></pre></div><p>Before we plot it, let&rsquo;s take a look at the data, so we can have a better sense of what we&rsquo;re visualizing. Let&rsquo;s look at the first 8 columns (pollinators) to have it fit relatively easily on the page:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># show in nicely-formatted table:</span>
</span></span><span class="line"><span class="cl"><span class="nf">kable</span><span class="p">(</span><span class="n">Safariland[</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="n">]</span><span class="p">,</span> <span class="n">row.names</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">kable_styling</span><span class="p">(</span><span class="n">full_width</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">position</span> <span class="o">=</span> <span class="s">&#34;left&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">bootstrap_options</span> <span class="o">=</span> <span class="s">&#34;condensed&#34;</span><span class="p">)</span>
</span></span></code></pre></div><table class="table table-condensed" style="">
 <thead>
  <tr>
   <th style="text-align:left;">  </th>
   <th style="text-align:right;"> Policana albopilosa </th>
   <th style="text-align:right;"> Bombus dahlbomii </th>
   <th style="text-align:right;"> Ruizantheda mutabilis </th>
   <th style="text-align:right;"> Trichophthalma amoena </th>
   <th style="text-align:right;"> Syrphus octomaculatus </th>
   <th style="text-align:right;"> Manuelia gayi </th>
   <th style="text-align:right;"> Allograpta.Toxomerus </th>
   <th style="text-align:right;"> Trichophthalma jaffueli </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Aristotelia chilensis </td>
   <td style="text-align:right;"> 673 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 110 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Alstroemeria aurea </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 154 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Schinus patagonicus </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Berberis darwinii </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Rosa eglanteria </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Cynanchum diemii </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Ribes magellanicum </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Mutisia decurrens </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Calceolaria crenatiflora </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
<p>Let&rsquo;s get right to the visualization! It&rsquo;s easy to use the <code>plotweb()</code> function to plot a network diagram:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plotweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/initial plotweb-1.png" width="672" />
<p>Above, we defined a network diagram as showing &ldquo;nodes as shapes, and links as lines between nodes&rdquo;. For the nodes, <code>plotweb()</code> depicts nodes as <em>rectangles</em>; the wider the rectangle, the more interactions were recorded for that node. Plants are shown on the bottom, since they&rsquo;re the &ldquo;lower&rdquo; (closer to basal energetically) level, and thus pollinators are shown on the higher level. For the links, they are also shown with widths scaled by the number of interactions.</p>
<p>For example, there were many, many interactions between the plant <em>Aristotelia chilensis</em> (also known as maqui or Chilean wineberry, whose fruit has recently been marketed as a &ldquo;superfood&rdquo;) and <em>Policana albopilosa</em>, a pretty Diphaglossine solitary bee whose genus name has been updated to <em>Cadeguala</em>. Thus, the line connecting these species is very wide (in fact, this link accounts for almost 60% of the observed interactions in this network). Many of the other interactions were only a single observation of that pollinator on that plant; those interactions are depicted by very narrow lines.</p>
<p>You many notice that this plot is kind of hard to read. In particular, a lot of the pollinator names overlap each other. We can do some minor tweaks to the plot and make it easier to interpret pretty easily. Let&rsquo;s rotate the plant and pollinator names to vertical positions, so they don&rsquo;t overlap, and change the colors of the nodes so that plants are green and pollinators are blue:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plotweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">text.rot</span><span class="o">=</span><span class="m">90</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.low</span> <span class="o">=</span> <span class="s">&#34;darkgreen&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.high</span> <span class="o">=</span> <span class="s">&#34;lightblue&#34;</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/plotweb II-1.png" width="672" />
<p>Well, that is kind of better&hellip; though now all the labels are cut off. We can adjust that with the <code>y.lim</code> option in <code>plotweb()</code>; in my experience you just have to iteratively mess around with the lower and upper limit numbers (<code>y.lim=c(-0.75,2.75)</code> in the code below) until you get a combination that works:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plotweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">text.rot</span><span class="o">=</span><span class="m">90</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.low</span> <span class="o">=</span> <span class="s">&#34;darkgreen&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.high</span> <span class="o">=</span> <span class="s">&#34;lightblue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">y.lim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.75</span><span class="p">,</span><span class="m">2.75</span><span class="p">))</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/plotweb III-1.png" width="672" />
<p>Now we have a pretty solid bipartite network depiction. We&rsquo;ll play around with just one more argument to this function: <code>method</code> which sets the arrangement of plants and pollinators. The default is <code>cca</code> which &ldquo;leads to as few crossings of interactions as possible&rdquo;. Below we&rsquo;ll plot it with <code>method = &quot;normal&quot;</code> which will leave the order the same as in the data:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plotweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">method</span> <span class="o">=</span> <span class="s">&#34;normal&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">text.rot</span><span class="o">=</span><span class="m">90</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.low</span> <span class="o">=</span> <span class="s">&#34;darkgreen&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.high</span> <span class="o">=</span> <span class="s">&#34;lightblue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">y.lim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.75</span><span class="p">,</span><span class="m">2.75</span><span class="p">))</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/plotweb IV-1.png" width="672" />
<p>It&rsquo;s helpful to see the rearrangement, and you could always go back into your data and rearrange them if you wanted a particular order (more on that below).</p>
<p>While again <code>bipartite</code> provides a decent starting point for plotting network diagrams, if you want to do a deep dive into network plots that are more customizable etc, we suggest looking into other packages such as <code>igraph</code>.</p>
<h2 id="matrix-depictions">Matrix depictions</h2>
<p>We&rsquo;ll now shift gears from network diagrams to matrix depictions. Here is an example matrix depiction of the Safariland dataset:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">visweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/visweb Safariland-1.png" width="672" />
<p>With the simplest function call (i.e. no alterations to the default arguments), <code>visweb()</code> gives us a solid depiction of this network. Yeah, I know&mdash;there&rsquo;s a gap between the matrix and the pollinator labels, which is standard with <code>visweb</code>. We&rsquo;ll come back to some alterations shortly.</p>
<h2 id="standardizing-matrix-depictions">Standardizing Matrix Depictions</h2>
<p>What is the difference between these two matrices?</p>
<p><img src="/courses/prework_network-visualization_files/figure-html/different depictions same matrix-1.png" width="450" /><img src="/courses/prework_network-visualization_files/figure-html/different depictions same matrix-2.png" width="450" /></p>
<p>They look pretty different, huh?
The second one gives off some distressed Jack-O-Lantern vibes&hellip;</p>
<p>Perhaps surprisingly, these are two different visualizations of the <em>exact same</em> network! How can that be?</p>
<p>Ultimately, as long as each interaction (data in a cell) is recorded faithfully (i.e., maintains the association between its row / plant and its column / pollinator), we can move around the order of <em>entire</em> rows and <em>entire</em> columns (relative to each other) and the data remains the same: it is still the same network. If we re-plot the two figures above, including the row and column labels, we can perhaps see that more easily:</p>
<p><img src="/courses/prework_network-visualization_files/figure-html/different depictions same matrix II-1.png" width="450" height="400" /><img src="/courses/prework_network-visualization_files/figure-html/different depictions same matrix II-2.png" width="450" height="400" /></p>
<p>With the row and column labels, you can confirm that the integrity of each interaction is maintained through both of these depictions.</p>
<p>For example, row <em>j</em> interacts with column 7 in both depictions, and you could hypothetically go through and confirm that for each of the 69 unique interactions in this made-up example (if you were really bored, that is).
To get more detailed without having to go interaction-by-interaction, row <em>a</em> interacts with columns 15 through 24, and this is easy to confirm in both graphs; it&rsquo;s just that the column order is different between the two.</p>
<p>Thinking about this, there is a <em>very</em> large number of ways that we could depict the same network&hellip;
if <em>R</em> were the number of rows and <em>C</em> the number of columns, then we could represent that network in $R! \times C!$ ways. For the example above with 24 rows and 24 columns, that is 24! $\times$ 24!, or more than 3 $\times$ $10^{47}$.
In other words, an unfathomably gigantic number of ways. Put another way, for a 100 $\times$ 100 network, this value is too large for R to calculate.</p>
<p>With so many potential options, we would ideally like to have a way to <em>standardize</em> how we depict a network in terms of the arrangement of the rows and columns.</p>
<h3 id="how-to-standardize">How to standardize</h3>
<p>Thankfully, there is a clear option in this regard (at least when it comes to bipartite networks): we sort the rows and the columns of the matrix by the <em>degree</em> or number of unique connections that each node has. We sort such that the most-generalist (highest degree) row is at the top, and the most-generalist column is at the left. This depiction maximizes our ability to detect <em>nestedness</em> in our networks, and some researchers refer to this arrangement as <strong>&ldquo;packing&rdquo; a matrix</strong>.</p>
<p>The <code>visweb</code> function includes options for how you display a network. Here is what the Safariland dataset looks like if the rows and columns are plotted in the order they are in the dataset (i.e. no rearrangement):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">visweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/visweb none-1.png" width="672" />
<p>If we wanted to standardize (order the rows and columns) by the <em>total count of interactions</em> for each taxon, we could instead use the bipartite default:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">visweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;nested&#34;</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/visweb nested-1.png" width="672" />
<p>This plot is exactly the same as the first plot of the Safariland data, but <em>slightly</em> different than the plot just before it (you can see some minor differences between the two plots, but they&rsquo;re pretty subtle). This isn&rsquo;t unusual, because common interactions are probabilistically likely to appear earlier in datasets, so often the order that data are in (e.g. from field notebooks) is correlated with&mdash;but not usually exactly the same as&mdash;the order of the same data that are sorted by number of interactions.</p>
<p>Unfortunately, the <code>visweb()</code> default  is not really the ideal way to see nestedness, which is instead to sort by degree or number of links per node (not total number of observed interactions). Because of this, many researchers in the bipartite network realm strongly prefer to order by <strong>degree</strong> instead of interaction count. To do that, you&rsquo;ll have to code it yourself. It&rsquo;s really not hard; some example code is below (and for aficionados of concise code, it would be straightforward to collapse this down into three lines of code).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">rowz</span> <span class="o">=</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">Safariland</span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span>                <span class="c1"># calculate plant degrees</span>
</span></span><span class="line"><span class="cl"><span class="n">colz</span> <span class="o">=</span> <span class="nf">colSums</span><span class="p">(</span><span class="n">Safariland</span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span>                <span class="c1"># calculate pollinator degree</span>
</span></span><span class="line"><span class="cl"><span class="n">roworder</span> <span class="o">=</span> <span class="nf">order</span><span class="p">(</span><span class="n">rowz</span><span class="p">,</span> <span class="n">decreasing</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>   <span class="c1"># order plants by degree</span>
</span></span><span class="line"><span class="cl"><span class="n">colorder</span> <span class="o">=</span> <span class="nf">order</span><span class="p">(</span><span class="n">colz</span><span class="p">,</span> <span class="n">decreasing</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>   <span class="c1"># order pollinators by degree</span>
</span></span><span class="line"><span class="cl"><span class="n">Safariland</span> <span class="o">=</span> <span class="n">Safariland[roworder</span><span class="p">,</span> <span class="n">colorder]</span> <span class="c1"># re-order rows and cols in matrix</span>
</span></span></code></pre></div><p>We&rsquo;ve now rearranged the row and column order in the Safariland dataset, so to plot it, just use <code>type = &quot;none&quot;</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">visweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/visweb none II-1.png" width="672" />
<p>Now that we&rsquo;re reordered our data, we can also use the reordered data to visualize a network diagram via <code>plotweb()</code>. In fact, we&rsquo;ll use the exact same code as above, with <code>method = &quot;normal&quot;</code>; but because we have rearranged the underlying data, the plot will be different:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">plotweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&#34;normal&#34;</span><span class="p">,</span> <span class="n">text.rot</span><span class="o">=</span><span class="m">90</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">        <span class="n">col.low</span> <span class="o">=</span> <span class="s">&#34;darkgreen&#34;</span><span class="p">,</span> <span class="n">col.high</span> <span class="o">=</span> <span class="s">&#34;lightblue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">y.lim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.75</span><span class="p">,</span><span class="m">2.75</span><span class="p">))</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/plotweb reordered-1.png" width="672" />
<p>In this plot, the plant and pollinator species that have the highest degree (largest number of unique interactions with species in the other group) are on the left, with degree decreasing as we move to the right. With this arrangement, we can see more clearly some of the hallmarks of nestedness: sharply sloping lines connecting generalists from one group (say plants) with specialists of the other group (pollinators), and vice-versa. In addition, we don&rsquo;t see many vertical lines at the right edge of the plot; such vertical lines indicate interactions occurring between specialists, which we don&rsquo;t typically find in nested networks.</p>
<p>At the same time, one can see why the default plotting option with <code>plotweb</code> is what it is; with this arrangement it&rsquo;s harder to trace the lines between interacting species to understand who is interacting with whom.</p>
<h3 id="diagonal-arrangement">Diagonal arrangement</h3>
<p>Back to matrix depictions: finally, <code>visweb</code> includes a third option, &ldquo;diagonal&rdquo; arrangement, which maximizes the number of interactions occurring along the diagonal of the bipartite matrix. While a non-standard way to depict matrices, it can be helpful for visually assessing modularity or compartments in the matrix. You can do that via <code>type = &quot;diagonal&quot;</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">visweb</span><span class="p">(</span><span class="n">Safariland</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;diagonal&#34;</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/visweb diagonal-1.png" width="672" />
<p>Here, <code>visweb()</code> shows us that there is one clear module in the network: the plant <em>Cynanchum diemii</em> is visited by four different pollinator taxa (two beetles and two wasps) that weren&rsquo;t recorded visiting any other plants. The rest of the network shows up as a separate and much more diffuse module.</p>
<p>One thing to know about using <code>type = &quot;diagonal&quot;</code> is that the algorithm is stochastic, so the plot could be different each time. For example, for the plot above, the <em>Cynanchum diemii</em> module can appear either at the top or the bottom.</p>
<h2 id="limitations-and-alterations-to-visweb">Limitations and alterations to <code>visweb</code></h2>
<p><code>visweb</code> is a great starting point for bipartite network visualization. It&rsquo;s straightforward to use, and because its use is almost ubiquitous among network ecologists, you and many others are probably familiar with the plotting style. Still, it has some limitations.</p>
<p>For example, you&rsquo;ve likely noticed that the default output for <code>visweb()</code> for the Safariland dataset yields a strange gap between the bottom of the matrix and the <em>x</em>-axis labels. This is typical with <code>visweb()</code> and can happen on the <em>y</em>-axis as well. Unless your matrix is very nearly square, you typically end up with a gap. Moreover, while there are some elements you can adjust, these plotting methods are not particularly flexible.</p>
<p>Below the visualization exercises we&rsquo;ve included some code for 1) fixing the issue with label spacing using the <code>gridGraphics</code> package; and 2) &ldquo;starter&rdquo; code for plotting matrix depictions with <code>ggplot2</code>, which is extremely customizable. Before you go there, though, do some practice with the exercises below:</p>
<h2 id="exercises">Exercises</h2>
<h3 id="for-those-new-to-plotting-networks">For those new to plotting networks</h3>
<p>Use the <a href="data/networks/medgarden.csv">medgarden.csv</a> data you put into matrix form in the &ldquo;Edgelist to Network&rdquo; section of our workshop Pre-work.</p>
<ul>
<li>plot via <code>plotweb</code>:
<ul>
<li>with no alterations; then</li>
<li>rotate text to 90º and get all of the labels to fit</li>
<li>change the colors of the plant and pollinator rectangles</li>
</ul>
</li>
<li>plot via <code>visweb</code>:
<ul>
<li>with <code>type = &quot;none&quot;</code></li>
<li>with <code>type = &quot;nested&quot;</code></li>
<li>with <code>type = &quot;diagonal&quot;</code></li>
</ul>
</li>
<li>&ldquo;pack&rdquo; (re-order) the matrix by plant and pollinator degree using the code included above (or your own variant if you prefer)
<ul>
<li>re-plot with <code>visweb</code>, using <code>type = &quot;none&quot;</code></li>
<li>re-plot with <code>plotweb</code> (with all of the alterations listed above)</li>
</ul>
</li>
</ul>
<p>If you&rsquo;d like more practice, you can also use with some of the data included in <code>bipartite</code>, e.g. <code>barrett1987</code>, <code>elberling1999</code>, <code>memmott1999</code>, or <code>motten1982</code> among others.</p>
<h3 id="for-those-with-experience-plotting-networks">For those with experience plotting networks</h3>
<p><strong>Choose your own plotting adventure!</strong> Pick one of the datasets included in <code>bipartite</code> (e.g. <code>memmott1999</code>) or use your own data or other data (e.g. from the <a href="https://www.web-of-life.es/tutorial/session-download-data.html#session-download-data" target="_blank" rel="noopener">Web of Life</a> database).</p>
<p>Some ideas&mdash;do what you are interested in:</p>
<ul>
<li><code>plotweb</code>
<ul>
<li>&ldquo;pack&rdquo; the data</li>
<li>compare a &ldquo;standard&rdquo; quantitative plot to a presence-absence plot where you transform all of the non-zero elements in the dataset (or preferably a copy of it) into 0s and 1s (hint to do this: <em>logical</em> data (T/F) in R are stored as 0/1 and can be multiplied, say, by 1)</li>
<li>play around with other formatting options (see <code>?plotweb</code>)</li>
</ul>
</li>
<li><code>visweb</code>
<ul>
<li>plot with and without &ldquo;packed&rdquo; data</li>
<li>play around with some of the color options, e.g.: <code>square=&quot;b&quot;,box.col=&quot;lightblue&quot;</code>; see <code>?visweb</code></li>
<li>use example code below with <code>gridGraphics</code> to fix the text spacing issue in a network that is far from square</li>
<li>if you&rsquo;re a <code>ggplot</code> aficionado, use the code below as a starting point to plot a network using <code>geom_raster</code></li>
</ul>
</li>
</ul>
<h2 id="alterations">Alterations</h2>
<h3 id="grid-graphics">Grid Graphics</h3>
<p>Below is code using the <code>gridGraphics</code> library to make the labels on <code>visweb</code> work better. This code works, but it&rsquo;s far from intuitive; for any plot you&rsquo;re adjusting you&rsquo;ll need to play around with the <code>labsize</code> and spacing (e.g. <code>unit(0.15, units = &quot;in&quot;)</code>) to get it to plot the way you&rsquo;d like.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">gridGraphics</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># port `visweb` output into a grid graphics object:</span>
</span></span><span class="line"><span class="cl"><span class="n">my_gTree</span> <span class="o">&lt;-</span> <span class="nf">grid.grabExpr</span><span class="p">(</span><span class="nf">grid.echo</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="nf">function</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nf">visweb</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">Safariland</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">prednames</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">preynames</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">labsize</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shift the left axis labels to the right</span>
</span></span><span class="line"><span class="cl"><span class="n">my_gTree[[</span><span class="s">&#34;children&#34;</span><span class="n">]][[</span><span class="s">&#34;graphics-plot-1-left-axis-labels-1&#34;</span><span class="n">]][[</span><span class="s">&#34;x&#34;</span><span class="n">]]</span> <span class="o">&lt;-</span> <span class="nf">unit</span><span class="p">(</span><span class="m">0.15</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;in&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shift the bottom axis labels upwards</span>
</span></span><span class="line"><span class="cl"><span class="n">my_gTree[[</span><span class="s">&#34;children&#34;</span><span class="n">]][[</span><span class="s">&#34;graphics-plot-1-bottom-axis-labels-1&#34;</span><span class="n">]][[</span><span class="s">&#34;y&#34;</span><span class="n">]]</span> <span class="o">&lt;-</span> <span class="nf">unit</span><span class="p">(</span><span class="m">1.3</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s">&#34;in&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">grid.newpage</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">grid.draw</span><span class="p">(</span><span class="n">my_gTree</span><span class="p">)</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/grid graphics example-1.png" width="672" height="500" />
<p>Definitely better than the base output; though note that I also had to play around with the <code>out.height</code> argument in the code chunk header to get this to print with a reasonable aspect ratio.</p>
<h3 id="ggplot-geom_raster">ggplot <code>geom_raster</code></h3>
<p><strong>Note that this code is fairly rudimentary</strong>; it&rsquo;s intended to be a starting point, rather than a fully-worked out solution. If you&rsquo;re keen to plot networks in <code>ggplot</code>, you can take this code and run with it. If you&rsquo;re not keen to do that, it&rsquo;s best to stick with <code>bipartite</code> or another solution.</p>
<p>Many of you may be familiar with using the <code>ggplot2</code> library (also included in the <code>tidyverse</code>) as a way to plot data. The <code>geom_raster</code> geom in <code>ggplot2</code> is a way to plot matrix depictions while keeping it straightforward to customize the plot in any number of ways (assuming you are familiar with <code>ggplot2</code>!).</p>
<p>In contrast to the <code>bipartite</code> plotting method, <code>ggplot2</code> requires that data are in a &ldquo;tidy&rdquo; data format (i.e. a data frame, not a network matrix). Our pre-work module on converting edge lists to networks gives some background on converting between these types. The code below assumes you have a network data matrix and converts it back to a dataframe, using <code>pivot_longer</code> (the opposite of the <code>pivot_wider</code> we used to move the data in the other formatting direction in the module on converting edge lists to networks).</p>
<p>The code below is set up as a function, so that you can include a matrix in the function argument and get a <code>ggplot</code> plot object back.</p>
<p>Some notes about working with <code>geom_raster</code> and the code below:</p>
<ul>
<li>when converting from a matrix into a data frame, any ordering is lost; if you want to &ldquo;pack&rdquo; your matrix, you have to sort your data by both the pollinator and the plant columns.
<ul>
<li>There are workarounds for specifying plotting order of discrete variables in <code>ggplot</code> so this is not insurmountable</li>
<li>The code below <em>doesn&rsquo;t do this;</em> it&rsquo;s in alphabetical order instead because of <code>pivot_longer</code> defaults.</li>
</ul>
</li>
<li><code>ggplot</code> uses the bottom left corner of a plot as the starting point, unlike <code>bipartite</code> which uses the top left. In other words, plants coming first in data order will be plotted at the bottom. So if you do &ldquo;pack&rdquo; your data frame, you&rsquo;ll want to sort the plants in reverse order (but pollinators in the typical order)
<ul>
<li>You&rsquo;ll notice in the plot below that plants are actually in <em>reverse</em> alphabetical order because of this</li>
<li>Sorting these data is tricky, however, since we only end up with a single column of data (interaction count for a given plant-pollinator pair). One workaround is to use <code>dplyr</code> to create new columns with <code>summarize</code> that tallies interactions on a per-species basis, for both plants and pollinators. Then you can sort the data by those columns. (Again, this is not done below)</li>
</ul>
</li>
<li>using plot defaults, raw network data, and <code>scale_fill_gradient</code> typically means that most interactions will be shaded so subtly as to not be noticeable.
<ul>
<li>a workaround is to set 0 values to <code>NA</code>, and use <code>scale_fill_steps</code>, specifying <code>na.value = &quot;white&quot;</code> and (e.g.) <code>low = &quot;#EEE&quot;</code> (<code>#EEE</code> is a very light grey)</li>
<li>for this to work well, you&rsquo;ll likely need to either transform the data or manually specify how to set the gradient, since most ecological network datasets have a lot of rare interactions and a few very common ones. Again, otherwise variation among relatively rare interactions will be difficult to parse visually.</li>
<li>In the code below, we opted for log-transforming the data to get more of a gradient; that&rsquo;s a reasonable approach but there are many other possibilities.</li>
</ul>
</li>
<li>gridlines are a little&hellip; strange in <code>geom_raster</code>; they are set for the <code>ggplot</code> defaults of plotting gridlines on integers (which of course makes sense for most plots), but that is actually right through the middle of our grid cells (and to be honest, any grid cell one might use in <code>geom_raster</code>). Instead, we want to plot the gridlines on the 0.5 marks.
<ul>
<li>The workaround we used below is to specify these with <code>geom_hline</code>, but it can probably be done with <code>panel_grid_major</code> (or <code>panel_grid_minor</code>).</li>
</ul>
</li>
</ul>
<p>Again, the code below is intended only as a starting point! Take it and run with it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># convenience function for matrix plotting</span>
</span></span><span class="line"><span class="cl"><span class="c1">#----------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># takes a matrix as an argument; conducts pivot_longer</span>
</span></span><span class="line"><span class="cl"><span class="c1"># to make it plottable by ggplot</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">matplotter</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">X</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">  <span class="nf">require</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">AR</span> <span class="o">=</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="nf">ncol</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="c1"># calculate aspect ratio</span>
</span></span><span class="line"><span class="cl">  <span class="n">dat</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># move plant (row) names to their own variable (column):</span>
</span></span><span class="line"><span class="cl">  <span class="n">dat</span><span class="o">$</span><span class="n">rowz</span> <span class="o">=</span> <span class="nf">row.names</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># pivot longer</span>
</span></span><span class="line"><span class="cl">  <span class="n">long</span> <span class="o">=</span> <span class="nf">pivot_longer</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">cols</span> <span class="o">=</span> <span class="o">!</span><span class="n">rowz</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;colz&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                      <span class="n">values_to</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># convert 0s to NAs for plotting</span>
</span></span><span class="line"><span class="cl">  <span class="n">long</span><span class="o">$</span><span class="n">n[long</span><span class="o">$</span><span class="n">n</span><span class="o">==</span><span class="m">0</span><span class="n">]</span> <span class="o">&lt;-</span><span class="kc">NA</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># log transform data for better visualization of the quantitative gradient</span>
</span></span><span class="line"><span class="cl">  <span class="n">long</span><span class="o">$</span><span class="n">n</span> <span class="o">=</span> <span class="nf">log</span><span class="p">(</span><span class="n">long</span><span class="o">$</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># plot using geom_raster</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">colz</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">rowz</span><span class="p">))</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">geom_raster</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">scale_fill_steps</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s">&#34;lightgray&#34;</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">na.value</span> <span class="o">=</span> <span class="s">&#34;white&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_void</span><span class="p">()</span> <span class="o">+</span> <span class="c1"># removes grid, axis ticks, etc. etc.</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">,</span> <span class="c1"># remove legend</span>
</span></span><span class="line"><span class="cl">          <span class="n">aspect.ratio</span> <span class="o">=</span> <span class="n">AR</span><span class="o">*</span><span class="m">0.95</span><span class="p">,</span> <span class="c1"># keeps it square (-ish)</span>
</span></span><span class="line"><span class="cl">          <span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">90</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                     <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="c1"># align at the top</span>
</span></span><span class="line"><span class="cl">                                     <span class="n">vjust</span> <span class="o">=</span> <span class="m">0.4</span><span class="p">),</span> <span class="c1"># align in the middle</span>
</span></span><span class="line"><span class="cl">          <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># manually add gridlines back in (probably a more elegant way to do this)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="m">0.5</span> <span class="o">+</span> <span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">long</span><span class="o">$</span><span class="n">rowz</span><span class="p">))</span> <span class="o">+</span> <span class="m">0.5</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">               <span class="n">colour</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="m">0.5</span> <span class="o">+</span> <span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">long</span><span class="o">$</span><span class="n">colz</span><span class="p">))</span> <span class="o">+</span> <span class="m">0.5</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">               <span class="n">colour</span> <span class="o">=</span> <span class="s">&#34;black&#34;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nf">return</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># test the function with the &#34;Safariland&#34; data</span>
</span></span><span class="line"><span class="cl"><span class="n">testplot</span> <span class="o">=</span> <span class="nf">matplotter</span><span class="p">(</span><span class="n">Safariland</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">testplot</span>
</span></span></code></pre></div><img src="/courses/prework_network-visualization_files/figure-html/geom raster function-1.png" width="672" />
          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/prework_edgelist-to-network/" rel="next">Prework - Edgelist-to-Network</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/wkshp_networks/" rel="prev">Networks</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Aug 27, 2025</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">

  



  

  

  

  
  






  
  
  

  
  
    
  
  
    
  

  

  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.67c1899ffe66384df9c7f0863a1232ab.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    
    <script src="https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":false}</script>

    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.3fae6f7398c36f9af32ddf3ea6e7760d.js"></script>

    
    
    
    
    
    






</body>
</html>
